{% extends "base.html" %}

{% block title %}Add New Script - Script Manager{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title">
                    ‚ûï Add New Script
                </h4>
            </div>
            <div class="card-body">
                <form method="post" id="addScriptForm">
                    <div class="mb-3">
                        <label for="scriptPath" class="form-label">
                            üìÑ Script Path <span class="text-danger">*</span>
                        </label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="scriptPath"
                            name="path" 
                            required 
                            placeholder="/path/to/your/script.py"
                            autocomplete="off"
                        >
                        <div class="form-text">
                            Full path to the Python script you want to manage
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="scriptArgs" class="form-label">
                            üíª Arguments
                        </label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="scriptArgs"
                            name="args" 
                            placeholder="--flag value --option"
                            autocomplete="off"
                        >
                        <div class="form-text">
                            Command line arguments to pass to the script (optional)
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="restartPolicy" class="form-label">
                            üîÑ Restart Policy
                        </label>
                        <select class="form-control" id="restartPolicy" name="policy">
                            <option value="never">Never - Don't restart on exit</option>
                            <option value="on-failure" selected>On Failure - Restart only on error</option>
                            <option value="always">Always - Always restart on exit</option>
                        </select>
                        <div class="form-text">
                            Choose when the script should be automatically restarted
                        </div>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="/" class="btn btn-outline-secondary">
                            ‚Üê Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            ‚úÖ Add Script
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Help Card -->
        <div class="card mt-4">
            <div class="card-header">
                <h6 class="card-title">
                    ‚ùì Quick Help
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary">Script Path Examples:</h6>
                        <ul style="list-style: none; padding-left: 0; font-size: 0.875rem; color: var(--text-muted);">
                            <li><code>/home/user/scripts/monitor.py</code></li>
                            <li><code>./scripts/worker.py</code></li>
                            <li><code>/opt/app/main.py</code></li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-primary">Arguments Examples:</h6>
                        <ul style="list-style: none; padding-left: 0; font-size: 0.875rem; color: var(--text-muted);">
                            <li><code>--config /etc/app.conf</code></li>
                            <li><code>--port 8080 --debug</code></li>
                            <li><code>--input data.csv --output results/</code></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
document.getElementById('addScriptForm').addEventListener('submit', function(e) {
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    // Show loading state
    submitBtn.innerHTML = '‚è≥ Adding...';
    submitBtn.disabled = true;
    
    // Reset button state after a delay (form will redirect, but in case of error)
    setTimeout(() => {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    }, 3000);
});

// Form validation feedback
(function() {
    'use strict';
    window.addEventListener('load', function() {
        const form = document.getElementById('addScriptForm');
        form.addEventListener('submit', function(event) {
            if (form.checkValidity() === false) {
                event.preventDefault();
                event.stopPropagation();
                showToast('Please fill in all required fields correctly.', 'danger');
            }
        }, false);
    }, false);
})();
</script>
{% endblock %}