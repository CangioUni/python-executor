<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Script - Script Manager</title>
<link rel="stylesheet" href="/static/css/style.css">
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<header class="header">
  <div class="container">
    <div class="header-content">
      <h1><i class="fas fa-terminal"></i> Script Manager</h1>
      <nav class="nav-links">
        <a href="/" class="btn btn-outline">
          <i class="fas fa-arrow-left"></i> Back to List
        </a>
      </nav>
    </div>
  </div>
</header>

<main class="main-content">
  <div class="container">
    <div class="card" style="max-width: 600px; margin: 0 auto;">
      <div class="card-header">
        <h2 class="card-title">
          <i class="fas fa-plus-circle"></i> Add New Script
        </h2>
      </div>
      <div class="card-body">
        <form method="post" id="addScriptForm">
          <div class="form-group">
            <label class="form-label" for="path">
              <i class="fas fa-file-code"></i> Script Path
            </label>
            <input 
              type="text" 
              id="path"
              name="path" 
              class="form-input" 
              required 
              placeholder="e.g., /path/to/your/script.py"
              pattern="^(/[^/\0]+)+/?$"
              title="Please enter a valid absolute path"
            >
            <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
              Enter the full path to your script file
            </small>
          </div>

          <div class="form-group">
            <label class="form-label" for="args">
              <i class="fas fa-terminal"></i> Arguments (Optional)
            </label>
            <input 
              type="text" 
              id="args"
              name="args" 
              class="form-input" 
              placeholder="e.g., --port 8080 --debug"
            >
            <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
              Command line arguments to pass to your script
            </small>
          </div>

          <div class="form-group">
            <label class="form-label" for="policy">
              <i class="fas fa-redo"></i> Restart Policy
            </label>
            <select name="policy" id="policy" class="form-select">
              <option value="never">Never restart</option>
              <option value="on-failure" selected>Restart on failure</option>
              <option value="always">Always restart</option>
            </select>
            <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
              Choose when the script should be automatically restarted
            </small>
          </div>

          <div class="d-flex gap-2 mt-4">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-plus"></i> Add Script
            </button>
            <a href="/" class="btn btn-secondary">
              <i class="fas fa-times"></i> Cancel
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</main>

<script>
// Form validation and enhancement
document.getElementById('addScriptForm').addEventListener('submit', function(e) {
  const submitBtn = e.target.querySelector('button[type="submit"]');
  const originalText = submitBtn.innerHTML;
  
  // Add loading state
  submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Adding...';
  submitBtn.disabled = true;
  
  // Simple client-side validation
  const pathInput = document.getElementById('path');
  const path = pathInput.value.trim();
  
  if (!path.startsWith('/')) {
    e.preventDefault();
    alert('Please enter an absolute path starting with /');
    submitBtn.innerHTML = originalText;
    submitBtn.disabled = false;
    pathInput.focus();
    return;
  }
  
  // If validation passes, form will submit normally
  // Reset button state after a short delay if submission fails
  setTimeout(() => {
    submitBtn.innerHTML = originalText;
    submitBtn.disabled = false;
  }, 5000);
});

// Auto-focus first input
document.getElementById('path').focus();

// Real-time path validation feedback
document.getElementById('path').addEventListener('input', function(e) {
  const value = e.target.value;
  const isValid = value.length === 0 || value.startsWith('/');
  
  e.target.style.borderColor = isValid ? '' : 'var(--error-color)';
  
  if (!isValid && value.length > 0) {
    e.target.style.boxShadow = '0 0 0 3px rgba(220, 38, 38, 0.1)';
  } else {
    e.target.style.boxShadow = '';
  }
});
</script>

<style>
.form-input:invalid {
  border-color: var(--error-color);
}

.form-input:invalid:focus {
  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
}

.form-input:valid {
  border-color: var(--success-color);
}

/* Enhance form layout on smaller screens */
@media (max-width: 480px) {
  .card {
    margin: 0 !important;
    border-radius: 0 !important;
  }
  
  .main-content {
    padding: 1rem 0 0 0;
  }
}
</style>
</body>
</html>